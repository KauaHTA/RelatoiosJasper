<!-- Created with Jaspersoft Studio version 7.0.3.final using JasperReports Library version 7.0.3-41034ca841d452f3305ba55b9042260aaa1ab5dd  -->
<jasperReport name="ResumodeTouroporCategoriadeMatriz" language="java" columnCount="1" pageWidth="842" pageHeight="595" columnWidth="832" leftMargin="5" rightMargin="5" topMargin="0" bottomMargin="0" uuid="db60ab55-021f-4047-8070-f41939d46052">
	<property name="com.jaspersoft.studio.data.sql.tables" value=""/>
	<property name="com.jaspersoft.studio.data.sql.SQLQueryDesigner.sash.w1" value="476"/>
	<property name="com.jaspersoft.studio.data.sql.SQLQueryDesigner.sash.w2" value="519"/>
	<property name="com.jaspersoft.studio.data.defaultdataadapter" value="FazendaGT"/>
	<property name="com.jaspersoft.studio.unit." value="pixel"/>
	<property name="com.jaspersoft.studio.unit.pageHeight" value="pixel"/>
	<property name="com.jaspersoft.studio.unit.pageWidth" value="pixel"/>
	<property name="com.jaspersoft.studio.unit.topMargin" value="pixel"/>
	<property name="com.jaspersoft.studio.unit.bottomMargin" value="pixel"/>
	<property name="com.jaspersoft.studio.unit.leftMargin" value="pixel"/>
	<property name="com.jaspersoft.studio.unit.rightMargin" value="pixel"/>
	<property name="com.jaspersoft.studio.unit.columnWidth" value="pixel"/>
	<property name="com.jaspersoft.studio.unit.columnSpacing" value="pixel"/>
	<parameter name="id_empresa" class="java.lang.Integer"/>
	<parameter name="id_campanha" class="java.lang.Integer"/>
	<query language="SQL"><![CDATA[SELECT 
    a.empresa,
    a.campanha,
    a.touro,
    a.categoria,
    a.qtde_matriz_prenha,
    a.qtde_matriz,
CAST(a.qtde_matriz_prenha AS numeric) / a.qtde_matriz AS perc_prenhez

FROM (
    SELECT 
        t.cod_animal AS touro,
        b.descricao AS categoria,
        xc.descricao AS campanha,
        e.nome AS empresa,
        SUM(CASE WHEN m.diagnostico_prenhez = 'P' THEN 1 ELSE 0 END) AS qtde_matriz_prenha,
        COUNT(DISTINCT m.id_animal_matriz) AS qtde_matriz
    FROM xgp_monta AS m
    JOIN xgp_animal AS t 
         ON m.id_animal_touro = t.id_animal
    JOIN xgp_categoria_matriz AS b 
         ON m.id_categoria_matriz = b.id_categoria_matriz
    JOIN xgp_campanha AS xc
         ON m.id_campanha = xc.id_campanha
    JOIN empresa AS e
         ON m.id_empresa = e.id_empresa
    WHERE m.id_empresa = $P{id_empresa} 
    and m.id_campanha = $P{id_campanha} 
   
    GROUP BY 
        t.cod_animal, 
        b.descricao, 
        xc.descricao, 
        e.nome
) AS a
WHERE a.qtde_matriz > 0 
]]></query>
	<field name="empresa" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.name" value="empresa"/>
		<property name="com.jaspersoft.studio.field.label" value="empresa"/>
		<property name="com.jaspersoft.studio.field.tree.path" value="empresa"/>
	</field>
	<field name="campanha" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.name" value="campanha"/>
		<property name="com.jaspersoft.studio.field.label" value="campanha"/>
		<property name="com.jaspersoft.studio.field.tree.path" value="xgp_campanha"/>
	</field>
	<field name="touro" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.name" value="touro"/>
		<property name="com.jaspersoft.studio.field.label" value="touro"/>
		<property name="com.jaspersoft.studio.field.tree.path" value="xgp_animal"/>
	</field>
	<field name="categoria" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.name" value="categoria"/>
		<property name="com.jaspersoft.studio.field.label" value="categoria"/>
		<property name="com.jaspersoft.studio.field.tree.path" value="xgp_categoria_matriz"/>
	</field>
	<field name="qtde_matriz_prenha" class="java.lang.Long">
		<property name="com.jaspersoft.studio.field.name" value="qtde_matriz_prenha"/>
		<property name="com.jaspersoft.studio.field.label" value="qtde_matriz_prenha"/>
	</field>
	<field name="qtde_matriz" class="java.lang.Long">
		<property name="com.jaspersoft.studio.field.name" value="qtde_matriz"/>
		<property name="com.jaspersoft.studio.field.label" value="qtde_matriz"/>
	</field>
	<field name="perc_prenhez" class="java.math.BigDecimal">
		<property name="com.jaspersoft.studio.field.name" value="perc_prenhez"/>
		<property name="com.jaspersoft.studio.field.label" value="perc_prenhez"/>
	</field>
	<variable name="primiparaqtde" calculation="Sum" class="java.lang.Integer">
		<expression><![CDATA[$F{categoria}.equals("Primipara") ? $F{qtde_matriz_prenha} : 0
]]></expression>
	</variable>
	<variable name="secindiparaqtde" calculation="Sum" class="java.lang.Integer">
		<expression><![CDATA[$F{categoria}.equals("Secundipara") ? $F{qtde_matriz_prenha} : 0
]]></expression>
	</variable>
	<variable name="Multiparaqtde" calculation="Sum" class="java.lang.Integer">
		<expression><![CDATA[$F{categoria}.equals("Multipara") ? $F{qtde_matriz_prenha} : 0
]]></expression>
	</variable>
	<variable name="precoceqtde" calculation="Sum" class="java.lang.Integer">
		<expression><![CDATA[$F{categoria}.equals("Precoce") ? $F{qtde_matriz_prenha} : 0
]]></expression>
	</variable>
	<variable name="qtde_matriz_prenha2" calculation="Sum" class="java.lang.Integer">
		<expression><![CDATA[$F{qtde_matriz_prenha}]]></expression>
	</variable>
	<background splitType="Stretch"/>
	<title height="67" splitType="Stretch">
		<element kind="staticText" uuid="04f82ac9-545e-4c5c-a293-e98ee860a2b6" x="190" y="20" width="440" height="30" fontSize="22.0" bold="true" hTextAlign="Center">
			<text><![CDATA[Resumo de Touro por Categoria de Matriz ]]></text>
		</element>
		<element kind="textField" uuid="d84cbb76-bbba-48f6-b400-8e8f384b16f6" x="760" y="35" width="52" height="15" fontSize="8.0" pattern="#,#00.###;(#,#00.###-)" bold="false">
			<expression><![CDATA[$V{PAGE_NUMBER}]]></expression>
		</element>
		<element kind="staticText" uuid="5886a6b6-debc-4e5f-8345-4afb2014145c" x="720" y="35" width="56" height="15" fontSize="8.0" bold="true">
			<text><![CDATA[PÁGINA:]]></text>
			<property name="com.jaspersoft.studio.unit.height" value="px"/>
		</element>
		<element kind="textField" uuid="53f39eee-5998-4581-ac70-02ffaa35bd7d" x="760" y="22" width="72" height="19" fontSize="8.0" pattern="dd/MM/yyyy h:mm" hTextAlign="Left">
			<expression><![CDATA[new java.util.Date()]]></expression>
		</element>
		<element kind="staticText" uuid="1086cc6c-a1bf-4c36-9527-f6d82e78db7e" x="720" y="22" width="84" height="19" fontSize="8.0" bold="true">
			<text><![CDATA[EMISSÃO:]]></text>
		</element>
	</title>
	<pageHeader height="76" splitType="Stretch">
		<element kind="rectangle" uuid="87453269-fcb1-45c8-affa-4248c05b5b5d" x="-10" y="54" width="902" height="20" forecolor="rgba(0, 0, 0, 0.0)" backcolor="rgba(207, 207, 207, 0.6745098)">
			<property name="com.jaspersoft.studio.unit.height" value="px"/>
		</element>
		<element kind="staticText" uuid="f93b8c75-64c0-4ae3-9215-efae2edef1f4" x="0" y="21" width="100" height="21" fontSize="10.0" bold="true">
			<text><![CDATA[EMPRESA:]]></text>
		</element>
		<element kind="textField" uuid="14b2b174-acd3-4c9b-924e-efedcdbe6ff0" x="54" y="21" width="196" height="21">
			<expression><![CDATA[$F{empresa}]]></expression>
		</element>
		<element kind="textField" uuid="ac58ab34-f4da-4f83-9ca2-84b042d31a8c" x="801" y="23" width="26" height="12" fontSize="8.0" pattern="#,#00.###;(#,#00.###-)">
			<printWhenExpression><![CDATA[$V{PAGE_NUMBER}.intValue() > 1
]]></printWhenExpression>
			<expression><![CDATA[$V{PAGE_NUMBER}]]></expression>
		</element>
		<element kind="staticText" uuid="cdde2729-0c1d-4c15-a48e-be4ed371c887" x="765" y="23" width="40" height="12" fontSize="8.0" bold="true">
			<printWhenExpression><![CDATA[$V{PAGE_NUMBER}.intValue() > 1]]></printWhenExpression>
			<text><![CDATA[PÁGINA:]]></text>
		</element>
		<element kind="textField" uuid="93942fd4-5efe-4235-911e-31f4aaaa51ca" x="369" y="55" width="70" height="19" evaluationTime="Report" pattern="#,#00.###;(#,#00.###-)" blankWhenNull="true">
			<expression><![CDATA[$V{primiparaqtde}]]></expression>
		</element>
		<element kind="textField" uuid="6a7354b4-b03d-4cc7-8d00-eee3f91e51f3" x="553" y="55" width="98" height="19" evaluationTime="Report" pattern="#,#00.###;(#,#00.###-)" blankWhenNull="true">
			<expression><![CDATA[$V{secindiparaqtde}]]></expression>
		</element>
		<element kind="textField" uuid="f7c5f820-d856-495c-8fb2-e978f062258f" x="742" y="55" width="97" height="19" evaluationTime="Report" pattern="#,#00.###;(#,#00.###-)" blankWhenNull="true">
			<expression><![CDATA[$V{Multiparaqtde}]]></expression>
		</element>
		<element kind="textField" uuid="c1376abe-d1ef-446c-a83d-fad2c04e8e5f" x="209" y="55" width="65" height="19" evaluationTime="Report" pattern="#,#00.###;(#,#00.###-)" blankWhenNull="true">
			<expression><![CDATA[$V{precoceqtde}]]></expression>
		</element>
		<element kind="staticText" uuid="cd72d69f-1aba-46a2-abcb-190e44b526e0" x="0" y="55" width="70" height="19" bold="true">
			<text><![CDATA[Total Prenha:]]></text>
		</element>
		<element kind="staticText" uuid="bdd8b2f5-d994-4d0e-8cfd-9553b47afde6" x="165" y="55" width="44" height="19" bold="true">
			<text><![CDATA[Precoce:]]></text>
		</element>
		<element kind="staticText" uuid="7aaea9a0-f7ea-4cdb-8da7-307b11317ec9" x="316" y="55" width="54" height="19" bold="true">
			<text><![CDATA[Primipara:]]></text>
		</element>
		<element kind="staticText" uuid="aa3b6b9d-420b-481f-bced-ddc025637a80" x="487" y="55" width="66" height="19" bold="true">
			<text><![CDATA[Secundipara:]]></text>
		</element>
		<element kind="staticText" uuid="d3280700-dd21-47a9-a1c8-a289ee4293df" x="692" y="55" width="50" height="19" bold="true">
			<text><![CDATA[Multipara:]]></text>
		</element>
		<element kind="textField" uuid="09943fdb-e4b5-4a88-bb12-d99b38ee7efe" x="70" y="55" width="89" height="19" evaluationTime="Report" pattern="#,#00.###;(#,#00.###-)">
			<expression><![CDATA[$V{qtde_matriz_prenha2}]]></expression>
		</element>
	</pageHeader>
	<columnHeader height="29" splitType="Stretch">
		<element kind="staticText" uuid="ce25fbe2-98cf-43d2-b7a9-f9f6f48bfac5" x="0" y="3" width="100" height="20" fontSize="11.0" bold="true" hTextAlign="Left" vTextAlign="Bottom">
			<text><![CDATA[Campanha]]></text>
		</element>
		<element kind="staticText" uuid="296dee40-062d-40a8-b61a-ff96d153a001" x="165" y="3" width="100" height="20" fontSize="11.0" bold="true" hTextAlign="Left" vTextAlign="Bottom">
			<text><![CDATA[Touro]]></text>
		</element>
		<element kind="staticText" uuid="6fcd0bca-5848-414b-9971-4e3604d97a0c" x="314" y="3" width="100" height="20" fontSize="11.0" bold="true" hTextAlign="Left" vTextAlign="Bottom">
			<text><![CDATA[Categoria Matiz]]></text>
		</element>
		<element kind="staticText" uuid="539419cd-9aef-4e30-abd3-abd139b08f73" x="564" y="3" width="100" height="20" fontSize="11.0" bold="true" hTextAlign="Right" vTextAlign="Bottom">
			<text><![CDATA[Qtde Prenha]]></text>
		</element>
		<element kind="staticText" uuid="d74b5b04-c5af-4eac-97f4-be29d65e7fa4" x="414" y="3" width="100" height="20" fontSize="11.0" bold="true" hTextAlign="Right" vTextAlign="Bottom">
			<text><![CDATA[Qtde Matriz ]]></text>
		</element>
		<element kind="staticText" uuid="b1c008bb-9210-41c0-b9b8-a95d1eaead8e" x="690" y="3" width="100" height="20" fontSize="11.0" bold="true" hTextAlign="Right" vTextAlign="Bottom">
			<text><![CDATA[% Prenhez]]></text>
		</element>
		<element kind="line" uuid="0f244186-783b-4490-92b8-06ac24dcd7c2" x="-22" y="25" width="970" height="1">
			<property name="com.jaspersoft.studio.unit.width" value="px"/>
		</element>
	</columnHeader>
	<detail>
		<band height="25" splitType="Stretch">
			<element kind="rectangle" uuid="5a131d08-76d4-4c02-94cb-981ff2e66f0f" x="-22" y="-4" width="902" height="25" forecolor="rgba(0, 0, 0, 0.0)" backcolor="rgba(207, 207, 207, 0.6745098)">
				<printWhenExpression><![CDATA[$V{REPORT_COUNT} % 2 != 0]]></printWhenExpression>
				<property name="com.jaspersoft.studio.unit.height" value="px"/>
			</element>
			<element kind="textField" uuid="e6a8f0fe-87de-42c6-a096-a8e0fd50a937" x="0" y="0" width="159" height="20" blankWhenNull="true">
				<expression><![CDATA[$F{campanha}]]></expression>
				<property name="com.jaspersoft.studio.spreadsheet.connectionID" value="3df62d4c-0376-4d4d-b575-44e10a226c00"/>
			</element>
			<element kind="textField" uuid="12fa62f7-1bde-4951-91a3-5809622c5246" x="165" y="0" width="155" height="20" blankWhenNull="true">
				<expression><![CDATA[$F{touro}]]></expression>
				<property name="com.jaspersoft.studio.spreadsheet.connectionID" value="10f0daf1-e11a-4de0-a467-45d1b0309ea9"/>
			</element>
			<element kind="textField" uuid="497c9a9b-e518-4177-a606-33e8fbe4aa0d" x="314" y="0" width="118" height="20" blankWhenNull="true">
				<expression><![CDATA[$F{categoria}]]></expression>
				<property name="com.jaspersoft.studio.spreadsheet.connectionID" value="576e7d89-d5a0-40b1-8618-1a909736c1bd"/>
			</element>
			<element kind="textField" uuid="77d53340-c29f-40df-9033-8d88070a98f9" x="564" y="0" width="99" height="20" pattern="#,#00.###;(#,##0.###-)" blankWhenNull="true" hTextAlign="Right">
				<expression><![CDATA[$F{qtde_matriz_prenha}]]></expression>
				<property name="com.jaspersoft.studio.spreadsheet.connectionID" value="c432bd74-3bab-46b3-ac3c-f1e3ecc7b86c"/>
			</element>
			<element kind="textField" uuid="a9bcd1e3-56a4-4303-aebd-fa1a1a46ff8d" x="414" y="0" width="99" height="20" pattern="#,#00.###;(#,##0.###-)" blankWhenNull="true" hTextAlign="Right">
				<expression><![CDATA[$F{qtde_matriz}]]></expression>
				<property name="com.jaspersoft.studio.spreadsheet.connectionID" value="8bc579fe-6a39-4a3b-bd05-19706f164331"/>
			</element>
			<element kind="textField" uuid="e4a9848b-b81e-4e02-a1ef-9fd5ae9aa374" x="690" y="0" width="99" height="20" pattern="00.00%;-#00.00 %" blankWhenNull="true" hTextAlign="Right">
				<expression><![CDATA[$F{perc_prenhez}]]></expression>
				<property name="com.jaspersoft.studio.spreadsheet.connectionID" value="925ca5a5-0121-4906-8c39-cc29626a3434"/>
			</element>
		</band>
	</detail>
</jasperReport>
